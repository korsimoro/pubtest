<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Using OpenID Connect Self-Issued to achieve Verifiable Credentials Presentation - RWoT DIR Launchpad</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Using OpenID Connect Self-Issued to achieve Verifiable Credentials Presentation", url: "#_top", children: [
              {title: "Authors:", url: "#authors" },
              {title: "Abstract", url: "#abstract" },
              {title: "Abstract", url: "#abstract_1" },
              {title: "Authorization Response", url: "#authorization-response" },
              {title: "Authorization Response Validation", url: "#authorization-response-validation" },
              {title: "Compliance with OpenID Connect", url: "#compliance-with-openid-connect" },
              {title: "Compliance with W3C Verifiable Credentials Specification", url: "#compliance-with-w3c-verifiable-credentials-specification" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    <h1 id="using-openid-connect-self-issued-to-achieve-verifiable-credentials-presentation">Using OpenID Connect Self-Issued to achieve Verifiable Credentials Presentation</h1>
<h2 id="authors">Authors:</h2>
<p>-Michael B. Jones
- Egidio Casati
- Andrés Junge
- Oliver Terbu
- Dmitri Zagidulin</p>
<h2 id="abstract">Abstract</h2>
<p>Use Cases
Technical Details
(Optional) Registration
Authorization Request
Requesting Claims in the Authorization Request
Authorization Response
Authorization Response Validation
Profile-specific Validation Rules for the Claims
Layers of Interoperability
W3C Verifiable Credentials Presentation using SIOP
Questions
Related Specs, for Reference</p>
<p>Outline 1
Abstract    1
Use Cases   2
Technical Details   2
(Optional) Registration 2
Authorization Request   2
Requesting Claims in the Authorization Request  2
Authorization Response  2
Authorization Response Validation   2
Profile-specific Validation Rules for the Claims    3
Layers of Interoperability  3
W3C Verifiable Credentials Presentation using SIOP  3
Questions   4
Related Specs, for Reference    4</p>
<h2 id="abstract_1">Abstract</h2>
<p>TBD: It is a business decision to make use of the W3C VC Presentation and not mandatory.
Use Cases
Send requested verifiable credential to RP using OpenID Connect, e.g., Self-Issued OP (SIOP)
Example: User is opening a bank account. On registration, the Bank (acting as the RP), wants to request one or more Verifiable Credentials from the user. The user’s wallet (acting as the Self-Issued OpenID Connect Provider) presents the user with the bank’s request (so they can select which credentials to send back). The wallet can then send the credentials back to the bank.</p>
<p>The RP can do this via a Self Issued OpenID Connect authorization request flow. 1) (Optional) The RP can register with the user’s wallet (acting as the Self-Issued OP), to provide signing and encryption keys, for example. 2) The RP performs the regular self-issued Authorization request,
Technical Details
(Optional) Registration
RP has a chance to register keys for signing and encryption (for the auth request below)
Authorization Request
As specified in OpenID Connect
(Also see Request Objects section below for additional possibilities)
Request object: signed/encrypted
plain
Requesting Claims in the Authorization Request</p>
<p>types of credentials requested
discuss scopes (wrt. registration)
possibly address schemas
need to address restricting source (e.g. we need claims only from Canadian sources)</p>
<h2 id="authorization-response">Authorization Response</h2>
<p>The authorization response contains the requested verifiable credentials in the id token.</p>
<h2 id="authorization-response-validation">Authorization Response Validation</h2>
<h3 id="profile-specific-validation-rules-for-the-claims">Profile-specific Validation Rules for the Claims</h3>
<p>In contrast to the OIDC specification, this document defines validation rules in case W3C Verifiable Credentials Presentation was included in the id token. Note, other methods exist to express and encode<br />
Layers of Interoperability
There are two layers of interoperability. First, it should be possible to demonstrate interoperability with traditional OIDC clients that implement the SIOP specification. This means, if OIDC claims/scopes were requested, the resulting W3C credentialsSubject will not be interpreted as a W3C Verifiable Credential Presentation. OIDC clients will inspect the signature of the id_token and verify the signature according to the OIDC SIOP specification.  Secondly, clients that additionally implement the W3C VC specification would extract the W3C VC Presentation from the id_token, and verify the proof. The proof follows the W3C VC Presentation specification, i.e., it is represented either as a JWS, or a JSON-LD proof.</p>
<h2 id="compliance-with-openid-connect">Compliance with OpenID Connect</h2>
<h2 id="compliance-with-w3c-verifiable-credentials-specification">Compliance with W3C Verifiable Credentials Specification</h2>
<pre><code>TBD: what is the role of distributed and aggregated claims?
</code></pre>
<p>W3C Verifiable Credentials Presentation using SIOP
RP request W3C VC in the OIDC authorization request using the claim and scope parameter.
The id token could be seen as the W3C VC Presentation. The id token could either be the W3C Verifiable Credentials Pr can be conveyed as OIDC claims in the id token.
Relationship to Aggregated and Distributed Claims and define Validation Rules in the DID Context.
...</p>
<p>OIDC
W3C Spec
Plain id_token</p>
<pre><code>{
   &quot;iss&quot;: &quot;http://server.example.com&quot;,
   &quot;sub&quot;: &quot;248289761001&quot;,
   &quot;aud&quot;: &quot;s6BhdRkqt3&quot;,
   &quot;nonce&quot;: &quot;n-0S6_WzA2Mj&quot;,
   &quot;exp&quot;: 1311281970,
   &quot;iat&quot;: 1311280970,
   &quot;name&quot;: &quot;Jane Doe&quot;,
   &quot;given_name&quot;: &quot;Jane&quot;,
   &quot;family_name&quot;: &quot;Doe&quot;,
   &quot;gender&quot;: &quot;female&quot;,
   &quot;birthdate&quot;: &quot;0000-10-31&quot;,
   &quot;email&quot;: &quot;janedoe@example.com&quot;,
   &quot;picture&quot;: &quot;http://example.com/janedoe/me.jpg&quot;
  }
</code></pre>

<p>Aggregated Claims (OIDC)</p>
<pre><code>{
  &quot;name&quot;: &quot;Jane Doe&quot;,
  &quot;given_name&quot;: &quot;Jane&quot;,
  &quot;family_name&quot;: &quot;Doe&quot;,
  &quot;birthdate&quot;: &quot;0000-03-22&quot;,
  &quot;eye_color&quot;: &quot;blue&quot;,
  &quot;email&quot;: &quot;janedoe@example.com&quot;,
  &quot;_claim_names&quot;: {
    &quot;address&quot;: &quot;src1&quot;,
    &quot;phone_number&quot;: &quot;src1&quot;
  },
  &quot;_claim_sources&quot;: {
    &quot;src1&quot;: {
      &quot;JWT&quot;: &quot;jwt_header.jwt_claims.jwt_signature&quot;  &lt;- JWT compact serialization
    }
  }
}
</code></pre>

<p>JSON object that MUST contain the JWT member whose value is a JWT [JWT] that MUST contain all the Claims in the _claim_names object that references the corresponding _claim_sources member. Other members MAY be present.</p>
<pre><code>// This is a single JWT:
{
  &quot;iss&quot;: &quot;did:example:ebfeb1f712ebc6f1c276e12ec21&quot;,
  &quot;jti&quot;: &quot;urn:uuid:3978344f-8596-4c3a-a978-8fcaba3903c5&quot;,
  &quot;aud&quot;: &quot;did:example:4a57546973436f6f6c4a4a57573&quot;,
  &quot;iat&quot;: &quot;1541493724&quot;,
  &quot;exp&quot;: &quot;1573029723&quot;,
  &quot;nonce&quot;: &quot;343s$FSFDa-&quot;,
  &quot;vp&quot;: {
    &quot;type&quot;: [&quot;VerifiablePresentation&quot;],
    // base64url-encoded JWT as string
    &quot;verifiableCredential&quot;: [&quot;...&quot;]   &lt;- where ‘address’ and ‘phone_number’ claims would go
  }
}
</code></pre>

<p>Distributed Claims (OIDC)</p>
<pre><code>{
  &quot;name&quot;: &quot;Jane Doe&quot;,
  &quot;given_name&quot;: &quot;Jane&quot;,
  &quot;family_name&quot;: &quot;Doe&quot;,
  &quot;email&quot;: &quot;janedoe@example.com&quot;,
  &quot;birthdate&quot;: &quot;0000-03-22&quot;,
  &quot;eye_color&quot;: &quot;blue&quot;,
  &quot;_claim_names&quot;: {
    &quot;payment_info&quot;: &quot;src1&quot;,
    &quot;shipping_address&quot;: &quot;src1&quot;,
    &quot;credit_score&quot;: &quot;src2&quot;
  },
  &quot;_claim_sources&quot;: {
    &quot;src1&quot;: {
      &quot;endpoint&quot;: &quot;https://bank.example.com/claim_source&quot;
    },
    &quot;src2&quot;: {
      &quot;endpoint&quot;: &quot;https://creditagency.example.com/claims_here&quot;,
      &quot;access_token&quot;: &quot;ksj3n283dke&quot;
    }
  }
}
</code></pre>

<p>Questions
Where to put the W3C Verifiable Credential claims? (ID Token, etc..)
Related Specs, for Reference
* https://openid.net/specs/openid-connect-core-1_0.html
* https://www.youtube.com/watch?v=tTeN_SxQ_OI , [NS18]
* https://nat.sakimura.org/2018/12/11/todo-list-for-self-issued-op/ , [NS18]
* https://iiw.idcommons.net/OIDC_DID-Auth_Profile , [II18]
* https://github.com/WebOfTrustInfo/rwot6-santabarbara/blob/master/final-documents/did-auth.md , [RWOT6]
* https://iiw.idcommons.net/Open_ID_v._FIDO_v._SSI
* https://w3c.github.io/vc-data-model/#json-web-token , [W3C]
* https://joinup.ec.europa.eu/sites/default/files/document/2015-11/eidas_saml_attribute_profile_v1.0_2.pdf (IT national eIDAS SAML Attribute profile]</p>

  <br>
</div>

<footer class="col-md-12 wm-page-content"><p>All of the contents of this directory are licensed CC-BY their contributors, unless otherwise noted.</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>